<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 10: Local Storage & Polish</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --border-color: #e2e8f0;
            --accent-color: #3b82f6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --code-bg: #f8fafc;
            --code-border: #e2e8f0;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            line-height: 1.6;
        }

        .layout-container {
            display: flex;
            min-height: calc(100vh - 58px);
        }

        /* Left Instruction Panel */
        .instruction-panel {
            width: 50%;
            background-color: var(--bg-primary);
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
            position: fixed;
            height: calc(100vh - 58px);
            left: 0;
            top: 58px;
        }

        .instruction-header {
            padding: 2rem;
            border-bottom: 1px solid var(--border-color);
            background-color: var(--bg-secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .back-button {
            background-color: var(--accent-color);
            color: white;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .back-button:hover {
            background-color: #2563eb;
            transform: translateY(-1px);
            color: white;
            text-decoration: none;
        }

        .instruction-header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin: 0;
            color: var(--text-primary);
        }

        .lesson-meta {
            font-size: 1rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .instruction-content {
            padding: 2rem;
        }

        .section {
            margin-bottom: 2.5rem;
        }

        .section h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent-color);
        }

        .section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            margin-top: 1.5rem;
        }

        .section p {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            line-height: 1.7;
        }

        .objectives-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .objectives-list li {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem;
            background-color: var(--bg-tertiary);
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
        }

        .objectives-list li .icon {
            color: var(--accent-color);
            margin-top: 0.125rem;
            font-size: 0.875rem;
        }

        .explanation-box {
            background-color: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid var(--success-color);
        }

        .explanation-box h4 {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tag-explanation {
            background-color: var(--code-bg);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border: 1px solid var(--code-border);
        }

        .tag-item {
            display: flex;
            flex-direction: column;
            margin-bottom: 1.25rem;
            padding-bottom: 1.25rem;
            border-bottom: 1px solid var(--border-color);
        }

        .tag-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .tag-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .tag-name {
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.875rem;
            background-color: var(--accent-color);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-weight: 500;
        }

        .tag-purpose {
            color: var(--text-muted);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .tag-description {
            color: var(--text-secondary);
            font-size: 0.9375rem;
            line-height: 1.6;
        }

        .progress-container {
            background-color: var(--bg-tertiary);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }

        .progress-bar {
            background-color: var(--border-color);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-fill {
            background-color: var(--accent-color);
            height: 100%;
            width: 10%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        /* Right Hands-on Panel */
        .hands-on-panel {
            width: 50%;
            margin-left: 50%;
            display: flex;
            flex-direction: column;
            background-color: var(--bg-primary);
            height: calc(100vh - 58px);}

        .hands-on-header {
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .hands-on-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0;
            color: var(--text-primary);
        }

        .activity-badge {
            background-color: var(--accent-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .editor-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 1rem;
            gap: 1rem;
            height: calc(100vh - 58px - 4rem);
            overflow: hidden;
        }

        .editor-section {
            flex: 1;
            background-color: var(--bg-primary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            overflow: hidden;
            min-height: 0;
            display: flex;
            flex-direction: column;
        }

        .editor-header {
            background-color: var(--bg-secondary);
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .editor-title {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .run-button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .run-button:hover {
            background-color: #7c3aed;
            transform: translateY(-1px);
        }

        #editor {
            flex: 1;
            width: 100%;
            min-height: 300px;
        }

        .output-section {
            flex: 1;
            background-color: var(--bg-primary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        min-height: 200px;
            display: flex;
            flex-direction: column;
        }

        .output-header {
            background-color: var(--bg-secondary);
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.5rem;
        }

        .expand-btn {
            background: none;
            border: none;
            padding: 0.25rem;
            cursor: pointer;
            color: var(--text-secondary);
            border-radius: 4px;
            line-height: 0;
        }

        .expand-btn:hover {
            background-color: var(--border-color);
            color: var(--text-primary);
        }

        .expand-btn svg {
            width: 16px;
            height: 16px;
        }

        #output {
            flex: 1;
            background: white;
            border: none;
            width: 100%;
        min-height: 0;
        }

        .tip-box {
            background-color: #fef3c7;
            border: 1px solid #fde68a;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid var(--warning-color);
        }

        .tip-box h5 {
            color: #92400e;
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tip-box p {
            color: #92400e;
            margin: 0;
            font-size: 0.9375rem;
        }

        .congratulations-box {
            border-radius: 12px;
            padding: 2rem;
            margin: 1.5rem 0;
            text-align: center;
        }

        .congratulations-box h4 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .congratulations-box p {
            margin-bottom: 0;
            font-size: 1.125rem;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .layout-container {
                flex-direction: column;
            }

            .instruction-panel {
                width: 100%;
                height: auto;
                position: relative;
                top: 0;
            }

            .hands-on-panel {
                width: 100%;
                margin-left: 0;
                margin-top: 0;
                min-height: calc(100vh - 58px);
                height: auto;
            }

            .editor-container {
                height: calc(100vh - 58px - 2rem);
            }

            .instruction-header,
            .hands-on-header {
                padding: 1rem;
            }

            .instruction-content {
                padding: 1rem;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
</head>

<body>
    <div class="auth-container">
        <style>
            .navbar {
                border-bottom: 1px solid #dedede;
            }

            .layout-container {
                min-height: calc(100vh - 58px);
            }

            .instruction-panel {}
        </style>
        <nav class="navbar navbar-expand bg-body-tertiary">
            <div class="container-fluid">
                <a class="navbar-brand" href="/">Full Stack Cloud Developer</a>
                <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                    <!-- <div class="navbar-nav">
                        <a class="nav-link active" aria-current="page" href="#">Home</a>
                        <a class="nav-link" href="#">Features</a>
                        <a class="nav-link" href="#">Pricing</a>
                    </div> -->
                </div>
                <div id="profile-container" class="dropdown d-none">
                    <img id="profile-picture" src="" class="rounded-circle dropdown-toggle"
                        style="width: 40px; height: 40px;" data-bs-toggle="dropdown" aria-expanded="false">
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li>
                            <h6 class="dropdown-header" id="profile-nickname"></h6>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="#" id="logout-button">Logout</a></li>
                    </ul>
                </div>
                <div class="ms-auto">
                    <div id="login-container" class="d-none">
                        <ul class="navbar-nav">
                            <li class="nav-item"><a class="nav-link" href="#" id="sign-up-button">Sign Up</a></li>
                            <li class="nav-item"><a class="nav-link" href="#" id="login-button">Login</a></li>
                        </ul>
                    </div>
                    <div id="profile-container" class="dropdown d-none">
                        <a href="#">
                            <img id="profile-picture" src="" class="rounded-circle dropdown-toggle"
                                style="width: 40px; height: 40px;" data-bs-toggle="dropdown" aria-expanded="false">
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li>
                                <h6 class="dropdown-header" id="profile-nickname"></h6>
                            </li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="#" id="logout-button">Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
        <script src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>
        <script src="auth0-service.js"></script>
        <script src="login.js"></script>
    </div>

    <div class="layout-container">
        <!-- Left Instruction Panel -->
        <div class="instruction-panel">
            <div class="instruction-header">
                <div>
                    <h1>Lesson 10: Local Storage & Polish</h1>
                    <div class="lesson-meta">
                        <div class="meta-item">
                            <i class="fas fa-clock text-muted"></i>
                            <span>60 minutes</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-users text-muted"></i>
                            <span>Ages 8-18+</span>
                        </div>
                    </div>
                </div>
                <a href="index.html?lesson=10" class="back-button">
                    <i class="fas fa-arrow-left"></i> Back to Lessons
                </a>
            </div>

            <div class="instruction-content">
                <div class="progress-container">
                    <div class="d-flex justify-content-between align-items-center">
                        <span class="fw-medium">Lesson Progress</span>
                        <span class="text-muted" id="progress-text">10%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill"></div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-save"></i> What You'll Learn Today</h2>
                    <p>In our final lesson, you'll learn how to make your todo app remember everything even after
                        closing the browser! We'll also add professional polish to make your app look and feel amazing.
                    </p>

                    <div class="explanation-box">
                        <h4><i class="fas fa-question-circle"></i> What is Local Storage?</h4>
                        <p>Local Storage is like a small filing cabinet in your browser that can save information
                            permanently. When you close your browser and come back later, the data is still there! This
                            is perfect for saving todo lists, user preferences, and other important information.</p>
                    </div>

                    <h3>Learning Objectives</h3>
                    <ul class="objectives-list">
                        <li>
                            <i class="fas fa-check-circle icon"></i>
                            <div>
                                <strong>Implement data persistence</strong> using localStorage to save and load todos.
                            </div>
                        </li>
                        <li>
                            <i class="fas fa-check-circle icon"></i>
                            <div>
                                <strong>Handle JSON data</strong> to store complex objects in localStorage.
                            </div>
                        </li>
                        <li>
                            <i class="fas fa-check-circle icon"></i>
                            <div>
                                <strong>Add professional polish</strong> with animations, error handling, and better
                                user experience.
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="section">
                    <h2><i class="fas fa-database"></i> Local Storage Methods</h2>
                    <p>Local Storage gives us simple methods to save and retrieve data. Here are the essential ones
                        you'll use:</p>

                    <div class="tag-explanation">
                        <div class="tag-item">
                            <div class="tag-header">
                                <span class="tag-name">localStorage.setItem(key, value)</span>
                                <span class="tag-purpose">Save Data</span>
                            </div>
                            <div class="tag-description">
                                This saves data to localStorage with a specific name (key). The data stays there until
                                you delete it or clear browser data. Perfect for saving your todo list!
                            </div>
                        </div>

                        <div class="tag-item">
                            <div class="tag-header">
                                <span class="tag-name">localStorage.getItem(key)</span>
                                <span class="tag-purpose">Load Data</span>
                            </div>
                            <div class="tag-description">
                                This retrieves previously saved data using its key. If no data exists with that key, it
                                returns <code>null</code> (empty).
                            </div>
                        </div>

                        <div class="tag-item">
                            <div class="tag-header">
                                <span class="tag-name">JSON.stringify(object)</span>
                                <span class="tag-purpose">Convert to Text</span>
                            </div>
                            <div class="tag-description">
                                localStorage can only save text, so we use this to convert our todo objects and arrays
                                into text format before saving.
                            </div>
                        </div>

                        <div class="tag-item">
                            <div class="tag-header">
                                <span class="tag-name">JSON.parse(text)</span>
                                <span class="tag-purpose">Convert from Text</span>
                            </div>
                            <div class="tag-description">
                                This converts saved text back into JavaScript objects and arrays so we can use them in
                                our code again.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-tasks"></i> Your Final Mission: Complete Todo App</h2>
                    <p>You'll complete the professional todo app by implementing localStorage and adding polish. The
                        basic structure is provided - you'll add the persistence and finishing touches.</p>

                    <div class="tip-box">
                        <h5><i class="fas fa-lightbulb"></i> Pro Tip</h5>
                        <p>Always wrap localStorage operations in try-catch blocks to handle errors gracefully. Some
                            browsers might have localStorage disabled!</p>
                    </div>

                    <ul class="objectives-list">
                        <li>
                            <i class="fas fa-save icon"></i>
                            <div>
                                <strong>Step 1: Implement `saveTodos()`</strong><br>
                                Use <code>localStorage.setItem()</code> and <code>JSON.stringify()</code> to save the
                                todos array to localStorage with the key 'todos'.
                            </div>
                        </li>
                        <li>
                            <i class="fas fa-upload icon"></i>
                            <div>
                                <strong>Step 2: Implement `loadTodos()`</strong><br>
                                Use <code>localStorage.getItem()</code> and <code>JSON.parse()</code> to load saved
                                todos when the app starts. Handle the case where no saved data exists.
                            </div>
                        </li>
                        <li>
                            <i class="fas fa-chart-bar icon"></i>
                            <div>
                                <strong>Step 3: Add Polish</strong><br>
                                Make sure to call <code>saveTodos()</code> after every change, handle empty states, and
                                test your app by refreshing the page!
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="congratulations-box">
                    <h4><i class="fas fa-graduation-cap"></i> Congratulations!</h4>
                    <p>You've successfully completed your first full web application with HTML, CSS, JavaScript, and
                        data persistence. This is a real developer skill!</p>
                    <div class="mt-3">
                        <div class="input-group mb-3">
                            <input type="text" id="studentName" class="form-control" placeholder="Enter your name" aria-label="Student name">
                            <button class="btn btn-light" type="button" onclick="generateCertificate()">
                                <i class="fas fa-certificate"></i> Get Your Completion Certificate
                            </button>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-rocket"></i> Take It Further</h2>
                    <p>After completing this lesson, you'll have built a complete, professional todo application! Here
                        are some ideas to make it even better:</p>

                    <ul class="objectives-list">
                        <li>
                            <i class="fas fa-edit icon"></i>
                            <div>Add the ability to edit existing tasks by double-clicking them</div>
                        </li>
                        <li>
                            <i class="fas fa-calendar icon"></i>
                            <div>Include due dates for tasks and show overdue items</div>
                        </li>
                        <li>
                            <i class="fas fa-tag icon"></i>
                            <div>Add categories or tags to organize tasks better</div>
                        </li>
                        <li>
                            <i class="fas fa-mobile icon"></i>
                            <div>Make your app work offline as a Progressive Web App (PWA)</div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Right Hands-on Panel -->
        <div class="hands-on-panel">
            <div class="hands-on-header">
                <h2 class="hands-on-title">Complete Todo App</h2>
                <span class="activity-badge">Final Project</span>
            </div>

            <div class="editor-container">
                <!-- Code Editor -->
                <div class="editor-section">
                    <div class="editor-header">
                        <div class="editor-title">
                            <i class="fas fa-file-code"></i>
                            todo-app.html
                        </div>
                        <button class="run-button" onclick="runCode()">
                            <i class="fas fa-play"></i> Run Code
                        </button>
                    </div>
                    <div id="editor"></div>
                </div>

                <!-- Output -->
                <div class="output-section">
                    <div class="output-header">
                        <div class="d-flex align-items-center" style="gap: 0.5rem;">
                            <i class="fas fa-desktop"></i>
                            <span>Your Complete Todo App</span>
                        </div>
                        <button class="expand-btn" id="openPreviewBtn" title="Open in new tab">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path
                                    d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" />
                            </svg>
                        </button>
                    </div>
                    <iframe id="output"></iframe>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
    <script>
        // Define openPreviewInNewTab in global scope so it can be accessed by the button
        let globalEditor;

        function openPreviewInNewTab() {
            if (globalEditor) {
                const code = globalEditor.getValue();
                const blob = new Blob([code], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                window.open(url, '_blank');
            }
        }
        let editor;

        // Initialize Monaco Editor
        require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' } });
        require(['vs/editor/editor.main'], function () {
            editor = monaco.editor.create(document.getElementById('editor'), {
                value: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Complete Todo App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            min-height: 100vh;
            font-family: 'Segoe UI', sans-serif;
            padding: 20px;
            background-color: aliceblue;
        }
        
        .todo-container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }
        
        .todo-header {
            padding: 2rem;
            text-align: center;
        }
        
        .todo-header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .todo-body {
            padding: 2rem;
        }
        
        .add-form {
            margin-bottom: 2rem;
        }
        
        .form-control {
            border-radius: 15px;
            border: 2px solid #e2e8f0;
            padding: 15px 20px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            border-color: #333333;
            box-shadow: 0 0 0 0.2rem rgba(139, 92, 246, 0.25);
        }
        
        .btn-add {
            border: none;
            border-radius: 15px;
            padding: 15px 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background-color: aliceblue;
            border-radius: 15px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
        }
        
        .stat-label {
            color: #64748b;
            font-size: 0.875rem;
        }
        
        .todo-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .todo-item {
            background: white;
            border-radius: 15px;
            margin-bottom: 1rem;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-left: 4px solid #333333;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
            animation: slideIn 0.5s ease;
        }
        
        .todo-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .todo-item.completed {
            opacity: 0.7;
            border-left-color: #10b981;
        }
        
        .todo-item.completed .todo-text {
            text-decoration: line-through;
            color: #64748b;
        }
        
        .todo-content {
            display: flex;
            align-items: center;
            flex-grow: 1;
        }
        
        .todo-checkbox {
            width: 20px;
            height: 20px;
            margin-right: 15px;
            cursor: pointer;
            accent-color: #333333;
        }
        
        .todo-text {
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        .todo-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn-delete {
            background: none;
            border: none;
            color: #ef4444;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .btn-delete:hover {
            background: rgba(239, 68, 68, 0.1);
            transform: scale(1.1);
        }
        
        .empty-state {
            text-align: center;
            color: #64748b;
            padding: 3rem 1rem;
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>

    <div class="todo-container">
        <div class="todo-header">
            <h1><i class="fas fa-tasks"></i> My Todo App</h1>
            <p class="mb-0">Stay organized and get things done!</p>
        </div>
        
        <div class="todo-body">
            <form class="add-form" onsubmit="addTodo(event)">
                <div class="input-group">
                    <input type="text" id="todoInput" class="form-control" 
                           placeholder="What needs to be done?" required>
                    <button type="submit" class="btn btn-primary btn-add text-white">
                        <i class="fas fa-plus"></i> Add Task
                    </button>
                </div>
            </form>
            
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="totalCount">0</div>
                    <div class="stat-label">Total</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="activeCount">0</div>
                    <div class="stat-label">Active</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="completedCount">0</div>
                    <div class="stat-label">Completed</div>
                </div>
            </div>
            
            <ul id="todoList" class="todo-list"></ul>
            
            <div id="emptyState" class="empty-state" style="display: none;">
                <i class="fas fa-clipboard-list"></i>
                <h4>No tasks yet!</h4>
                <p>Add a task above to get started organizing your day</p>
            </div>
        </div>
    </div>

    <script>
        // Your todos array - this will store all your tasks
        let todos = [];

        // Step 1: Complete the saveTodos function
        function saveTodos() {
            try {
                // YOUR TASK: Save the todos array to localStorage
                // Hint: Set the localStorage item for todos: ('todos', json)
                // Hint: Convert todos array to text using JSON.stringify(todos)
                
            } catch (error) {
                console.error('Error saving todos:', error);
            }
        }

        // Step 2: Complete the loadTodos function
        function loadTodos() {
            try {
                // YOUR TASK: Load saved todos from localStorage
                // Hint: Get the localStorage item for todos
                
                // YOUR TASK: Check if saved data exists and parse it
                // Hint: Check that there are any saved todos with an if statement
                // Hint: If there are parse the todos
                // Hint: If not set todos to an empty array
                
            } catch (error) {
                console.error('Error loading todos:', error);
                todos = []; // Start fresh if there's an error
            }
        }

        function updateStats() {
            // YOUR TASK: Calculate the statistics
            const total = todos.length;
            const completed = todos.filter(todo => todo.completed).length;
            const active = total - completed;
            
            // YOUR TASK: Update the DOM elements with the counts
            document.getElementById('totalCount').textContent = total;
            document.getElementById('activeCount').textContent = active;
            document.getElementById('completedCount').textContent = completed;
        }

        // Add a new todo
        function addTodo(event) {
            event.preventDefault();
            
            const input = document.getElementById('todoInput');
            const text = input.value.trim();
            
            if (text === '') return;
            
            // Create new todo object
            const newTodo = {
                id: Date.now(), // Simple ID using timestamp
                text: text,
                completed: false,
                createdAt: new Date().toISOString()
            };
            
            // Add to beginning of array (newest first)
            todos.unshift(newTodo);
            
            // Clear the input
            input.value = '';
            
            // Save to localStorage and update display
            // Step 3: Make sure to save after changes!
            displayTodos();
            updateStats();
        }

        // Toggle todo completion
        function toggleTodo(id) {
            todos = todos.map(todo => 
                todo.id === id ? { ...todo, completed: !todo.completed } : todo
            );
            // Step 3: Make sure to save after changes!
            displayTodos();
            updateStats();
        }

        // Delete a todo
        function deleteTodo(id) {
            todos = todos.filter(todo => todo.id !== id);
            // Step 3: Make sure to save after changes!
            displayTodos();
            updateStats();
        }

        // Display all todos
        function displayTodos() {
            const todoList = document.getElementById('todoList');
            const emptyState = document.getElementById('emptyState');
            
            if (todos.length === 0) {
                todoList.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            }
            
            todoList.style.display = 'block';
            emptyState.style.display = 'none';
            
            todoList.innerHTML = todos.map(todo => \`
                <li class="todo-item \${todo.completed ? 'completed' : ''}">
                    <div class="todo-content">
                        <input type="checkbox" class="todo-checkbox" 
                               \${todo.completed ? 'checked' : ''} 
                               onchange="toggleTodo(\${todo.id})">
                        <span class="todo-text">\${escapeHtml(todo.text)}</span>
                    </div>
                    <div class="todo-actions">
                        <button class="btn-delete" onclick="deleteTodo(\${todo.id})" 
                                title="Delete task">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </li>
            \`).join('');
        }

        // Safely display user text (prevent XSS attacks)
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Initialize the app when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved todos from localStorage
            loadTodos();
            
            // Add some demo data if no saved todos exist
            if (todos.length === 0) {
                // Create some example todos to show how the app works
                const demoTodos = [
                    { id: 1, text: 'Welcome to your todo app! âœ¨', completed: false, createdAt: new Date().toISOString() },
                    { id: 2, text: 'Try adding your own task above', completed: false, createdAt: new Date().toISOString() },
                    { id: 3, text: 'Click the checkbox to complete tasks', completed: false, createdAt: new Date().toISOString() },
                    { id: 4, text: 'Your tasks will be saved automatically!', completed: true, createdAt: new Date().toISOString() }
                ];
                
                // Add demo todos one by one with animation
                demoTodos.forEach((todo, index) => {
                    setTimeout(() => {
                        todos.push(todo);
                        // Step 3: Make sure to save after changes!
                        displayTodos();
                        updateStats();
                    }, index * 300);
                });
            }
            
            // Display the todos and update stats (for saved todos or initial state)
            displayTodos();
            updateStats();
        });
    <\/script>

</body>
</html>`,
                language: 'html',
                theme: 'vs',
                fontSize: 14,
                minimap: { enabled: false },
                scrollBeyondLastLine: false,
                automaticLayout: true,
                tabSize: 4,
                insertSpaces: true,
                wordWrap: 'on',
                lineNumbers: 'on',
                folding: true,
                bracketMatching: 'always',
                autoIndent: 'full'
            });

            // Store reference to global scope
            globalEditor = editor;

            // Auto-run code when user stops typing
            let timeout;
            editor.onDidChangeModelContent(() => {
                clearTimeout(timeout);
                timeout = setTimeout(runCode, 500);
            });

            // Initial run
            runCode();

            // Attach event listener to the open preview button
            document.getElementById('openPreviewBtn').addEventListener('click', openPreviewInNewTab);
        });

        function runCode() {
            const code = editor.getValue();
            const output = document.getElementById('output');

            const blob = new Blob([code], { type: 'text/html' });
            const url = URL.createObjectURL(blob);

            output.src = url;

            updateProgress(code);
        }

        function updateProgress(code) {
            const progressFill = document.querySelector('.progress-fill');
            const progressText = document.getElementById('progress-text');
            let progress = 10; // Base progress for having the starter code

            // Check for saveTodos implementation
            if (code.includes("localStorage.setItem('todos',")) progress += 20;
            if (code.includes("JSON.stringify(todos)")) progress += 15;

            // Check for loadTodos implementation
            if (code.includes("localStorage.getItem('todos')")) progress += 15;
            if (code.includes("const savedTodos =")) progress += 5;
            if (code.includes("if (savedTodos)")) progress += 10;
            if (code.includes("JSON.parse(savedTodos)")) progress += 15;
            if (code.includes("todos = [];") && code.includes("} else {")) progress += 5;

            // Check for updateStats implementation
            if (code.includes("const total = todos.length")) progress += 5;
            if (code.includes("const completed = todos.filter(todo => todo.completed).length")) progress += 5;
            if (code.includes("const active = total - completed")) progress += 5;
            if (code.includes("getElementById('totalCount').textContent = total")) progress += 5;
            if (code.includes("getElementById('activeCount').textContent = active")) progress += 5;
            if (code.includes("getElementById('completedCount').textContent = completed")) progress += 5;

            const finalProgress = Math.min(progress, 100);
            progressFill.style.width = finalProgress + '%';
            progressText.textContent = finalProgress + '%';
        }

        // Generate certificate function in global scope
        async function generateCertificate() {
            const studentName = document.getElementById('studentName').value.trim();
            if (studentName) {
                const encodedName = encodeURIComponent(studentName);
                const encodedInstructorName = encodeURIComponent("Full Stack Cloud Developer");
                window.open(`certificate.html?name=${encodedName}&instructor=${encodedInstructorName}`, '_blank');
            } else {
                alert("Please enter your name to receive your certificate!");
            }
        }

        // Execute the login function
        login();
    </script>
</body>

</html>
