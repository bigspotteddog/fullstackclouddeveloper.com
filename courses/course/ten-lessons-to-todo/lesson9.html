<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 9: Advanced Todo Features</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --border-color: #e2e8f0;
            --accent-color: #3b82f6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --code-bg: #f8fafc;
            --code-border: #e2e8f0;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            line-height: 1.6;
        }

        .layout-container {
            display: flex;
            min-height: calc(100vh - 58px);
        }

        /* Left Instruction Panel */
        .instruction-panel {
            width: 50%;
            background-color: var(--bg-primary);
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
            position: fixed;
            height: calc(100vh - 58px);
            left: 0;
            top: 58px;
        }

        .instruction-header {
            padding: 2rem;
            border-bottom: 1px solid var(--border-color);
            background-color: var(--bg-secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .back-button {
            background-color: var(--accent-color);
            color: white;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .back-button:hover {
            background-color: #2563eb;
            transform: translateY(-1px);
            color: white;
            text-decoration: none;
        }

        .instruction-header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin: 0;
            color: var(--text-primary);
        }

        .lesson-meta {
            font-size: 1rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .instruction-content {
            padding: 2rem;
        }

        .section {
            margin-bottom: 2.5rem;
        }

        .section h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent-color);
        }

        .section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            margin-top: 1.5rem;
        }

        .section p {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            line-height: 1.7;
        }

        .objectives-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .objectives-list li {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem;
            background-color: var(--bg-tertiary);
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
        }

        .objectives-list li .icon {
            color: var(--accent-color);
            margin-top: 0.125rem;
            font-size: 0.875rem;
        }

        .explanation-box {
            background-color: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid var(--success-color);
        }

        .explanation-box h4 {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tag-explanation {
            background-color: var(--code-bg);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border: 1px solid var(--code-border);
        }

        .tag-item {
            display: flex;
            flex-direction: column;
            margin-bottom: 1.25rem;
            padding-bottom: 1.25rem;
            border-bottom: 1px solid var(--border-color);
        }

        .tag-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .tag-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .tag-name {
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.875rem;
            background-color: var(--accent-color);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-weight: 500;
        }

        .tag-purpose {
            color: var(--text-muted);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .tag-description {
            color: var(--text-secondary);
            font-size: 0.9375rem;
            line-height: 1.6;
        }

        .progress-container {
            background-color: var(--bg-tertiary);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }

        .progress-bar {
            background-color: var(--border-color);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-fill {
            background-color: var(--accent-color);
            height: 100%;
            width: 10%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        /* Right Hands-on Panel */
        .hands-on-panel {
            width: 50%;
            margin-left: 50%;
            display: flex;
            flex-direction: column;
            background-color: var(--bg-primary);
            height: calc(100vh - 58px);}

        .hands-on-header {
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .hands-on-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0;
            color: var(--text-primary);
        }

        .activity-badge {
            background-color: var(--accent-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .editor-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 1rem;
            gap: 1rem;
            height: calc(100vh - 58px - 4rem);
            overflow: hidden;
        }

        .editor-section {
            flex: 1;
            background-color: var(--bg-primary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            overflow: hidden;
            min-height: 0;
            display: flex;
            flex-direction: column;
        }

        .editor-header {
            background-color: var(--bg-secondary);
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .editor-title {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .run-button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .run-button:hover {
            background-color: #7c3aed;
            transform: translateY(-1px);
        }

        #editor {
            flex: 1;
            width: 100%;
            min-height: 300px;
        }

        .output-section {
            flex: 1;
            background-color: var(--bg-primary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        min-height: 200px;
            display: flex;
            flex-direction: column;
        }

        .output-header {
            background-color: var(--bg-secondary);
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.5rem;
        }

        .expand-btn {
            background: none;
            border: none;
            padding: 0.25rem;
            cursor: pointer;
            color: var(--text-secondary);
            border-radius: 4px;
            line-height: 0;
        }

        .expand-btn:hover {
            background-color: var(--border-color);
            color: var(--text-primary);
        }

        .expand-btn svg {
            width: 16px;
            height: 16px;
        }

        #output {
            flex: 1;
            background: white;
            border: none;
            width: 100%;
        min-height: 0;
        }

        .tip-box {
            background-color: #fef3c7;
            border: 1px solid #fde68a;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid var(--warning-color);
        }

        .tip-box h5 {
            color: #92400e;
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tip-box p {
            color: #92400e;
            margin: 0;
            font-size: 0.9375rem;
        }

        .challenge-box {
            background-color: #e0e7ff;
            border: 1px solid #c7d2fe;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid var(--accent-color);
        }

        .challenge-box h5 {
            color: var(--accent-color);
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .challenge-box p {
            color: #4338ca;
            margin: 0;
            font-size: 0.9375rem;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .layout-container {
                flex-direction: column;
            }

            .instruction-panel {
                width: 100%;
                height: auto;
                position: relative;
                top: 0;
            }

            .hands-on-panel {
                width: 100%;
                margin-left: 0;
                margin-top: 0;
                min-height: calc(100vh - 58px);
                height: auto;
            }

            .editor-container {
                height: calc(100vh - 58px - 2rem);
            }

            .instruction-header,
            .hands-on-header {
                padding: 1rem;
            }

            .instruction-content {
                padding: 1rem;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
</head>

<body>
    <div class="auth-container">
        <style>
            .navbar {
                border-bottom: 1px solid #dedede;
            }

            .layout-container {
                min-height: calc(100vh - 58px);
            }

            .instruction-panel {}
        </style>
        <nav class="navbar navbar-expand bg-body-tertiary">
            <div class="container-fluid">
                <a class="navbar-brand" href="/courses">Full Stack Cloud Developer</a>
                <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                    <!-- <div class="navbar-nav">
                        <a class="nav-link active" aria-current="page" href="#">Home</a>
                        <a class="nav-link" href="#">Features</a>
                        <a class="nav-link" href="#">Pricing</a>
                    </div> -->
                </div>
                <div id="profile-container" class="dropdown d-none">
                    <img id="profile-picture" src="" class="rounded-circle dropdown-toggle"
                        style="width: 40px; height: 40px;" data-bs-toggle="dropdown" aria-expanded="false">
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li>
                            <h6 class="dropdown-header" id="profile-nickname"></h6>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="#" id="logout-button">Logout</a></li>
                    </ul>
                </div>
                <div class="ms-auto">
                    <div id="login-container" class="d-none">
                        <ul class="navbar-nav">
                            <li class="nav-item"><a class="nav-link" href="#" id="sign-up-button">Sign Up</a></li>
                            <li class="nav-item"><a class="nav-link" href="#" id="login-button">Login</a></li>
                        </ul>
                    </div>
                    <div id="profile-container" class="dropdown d-none">
                        <a href="#">
                            <img id="profile-picture" src="" class="rounded-circle dropdown-toggle"
                                style="width: 40px; height: 40px;" data-bs-toggle="dropdown" aria-expanded="false">
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li>
                                <h6 class="dropdown-header" id="profile-nickname"></h6>
                            </li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="#" id="logout-button">Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
        <script src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>
        <script src="auth0-service.js"></script>
        <script src="login.js"></script>
    </div>

    <div class="layout-container">
        <!-- Left Instruction Panel -->
        <div class="instruction-panel">
            <div class="instruction-header">
                <div>
                    <h1>Lesson 9: Advanced Todo Features</h1>
                    <div class="lesson-meta">
                        <div class="meta-item">
                            <i class="fas fa-clock text-muted"></i>
                            <span>60 minutes</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-users text-muted"></i>
                            <span>Ages 8-18+</span>
                        </div>
                    </div>
                </div>
                <a href="index.html?lesson=9" class="back-button">
                    <i class="fas fa-arrow-left"></i> Back to Lessons
                </a>
            </div>

            <div class="instruction-content">
                <div class="progress-container">
                    <div class="d-flex justify-content-between align-items-center">
                        <span class="fw-medium">Lesson Progress</span>
                        <span class="text-muted" id="progress-text">10%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill"></div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-cogs"></i> What You'll Learn Today</h2>
                    <p>Now it's time to make your todo app truly powerful! Today you'll learn how to delete tasks, mark
                        them as complete, and track statistics. We'll build on everything you learned in the previous
                        lessons to create a fully functional todo application.</p>

                    <div class="explanation-box">
                        <h4><i class="fas fa-question-circle"></i> Why Advanced Features Matter</h4>
                        <p>A basic todo app that only adds items isn't very useful in real life. People need to complete
                            tasks, remove things they no longer need, and see their progress. These features make your
                            app actually usable and show you're thinking like a real developer!</p>
                    </div>

                    <h3>Learning Objectives</h3>
                    <ul class="objectives-list">
                        <li>
                            <i class="fas fa-check-circle icon"></i>
                            <div>
                                <strong>Implement toggle functionality</strong> to mark tasks as complete or incomplete.
                            </div>
                        </li>
                        <li>
                            <i class="fas fa-check-circle icon"></i>
                            <div>
                                <strong>Add delete functionality</strong> to remove tasks from the list.
                            </div>
                        </li>
                        <li>
                            <i class="fas fa-check-circle icon"></i>
                            <div>
                                <strong>Track and display statistics</strong> showing total, active, and completed
                                tasks.
                            </div>
                        </li>
                        <li>
                            <i class="fas fa-check-circle icon"></i>
                            <div>
                                <strong>Handle complex user interactions</strong> and update the interface dynamically.
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="section">
                    <h2><i class="fas fa-code"></i> Advanced JavaScript Concepts</h2>
                    <p>To build these advanced features, we'll use some powerful JavaScript concepts. Don't worry -
                        we'll explain each one step by step!</p>

                    <div class="tag-explanation">
                        <div class="tag-item">
                            <div class="tag-header">
                                <span class="tag-name">array.filter()</span>
                                <span class="tag-purpose">Remove Items</span>
                            </div>
                            <div class="tag-description">
                                This method creates a new array with only the items that pass a test. Perfect for
                                deleting todo items! For example:
                                <code>todos.filter(todo => todo.id !== deleteId)</code> removes the item with that ID.
                            </div>
                        </div>

                        <div class="tag-item">
                            <div class="tag-header">
                                <span class="tag-name">array.map()</span>
                                <span class="tag-purpose">Transform Items</span>
                            </div>
                            <div class="tag-description">
                                This method creates a new array by transforming each item. We'll use it to toggle
                                completion status:
                                <code>todos.map(todo => todo.id === id ? {...todo, completed: !todo.completed} : todo)</code>
                            </div>
                        </div>

                        <div class="tag-item">
                            <div class="tag-header">
                                <span class="tag-name">...spread operator</span>
                                <span class="tag-purpose">Copy Objects</span>
                            </div>
                            <div class="tag-description">
                                The three dots (...) copy all properties from an object. This lets us change one
                                property without affecting the original: <code>{...todo, completed: true}</code>
                            </div>
                        </div>

                        <div class="tag-item">
                            <div class="tag-header">
                                <span class="tag-name">onclick with parameters</span>
                                <span class="tag-purpose">Pass Data to Functions</span>
                            </div>
                            <div class="tag-description">
                                We can pass specific data (like a todo's ID) to our functions:
                                <code>onclick="deleteTodo(${todo.id})"</code>. This lets each button know which item to
                                work with.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-tasks"></i> Your Mission: Complete the Todo App</h2>
                    <p>Your starter code has a basic todo app, but it's missing the most important features! You'll
                        implement three key functions to make it fully functional.</p>

                    <div class="tip-box">
                        <h5><i class="fas fa-lightbulb"></i> Pro Tip</h5>
                        <p>Test each function as you complete it. Try adding a task, then toggle it, then delete it.
                            Make sure the statistics update correctly!</p>
                    </div>

                    <ul class="objectives-list">
                        <li>
                            <i class="fas fa-toggle-on icon"></i>
                            <div>
                                <strong>Step 1: Complete `toggleTodo(id)`</strong><br>
                                Find the todo with the matching ID and flip its <code>completed</code> status from true
                                to false or vice versa. Use <code>array.map()</code> and the spread operator to create a
                                new array with the updated todo.
                            </div>
                        </li>
                        <li>
                            <i class="fas fa-trash icon"></i>
                            <div>
                                <strong>Step 2: Complete `deleteTodo(id)`</strong><br>
                                Remove the todo with the matching ID from the array. Use <code>array.filter()</code> to
                                create a new array without that item. Remember to also update the display and stats!
                            </div>
                        </li>
                        <li>
                            <i class="fas fa-chart-bar icon"></i>
                            <div>
                                <strong>Step 3: Complete `updateStats()`</strong><br>
                                Calculate and display the total number of todos, how many are active (not completed),
                                and how many are completed. Update the HTML elements with these numbers.
                            </div>
                        </li>
                    </ul>

                    <div class="challenge-box">
                        <h5><i class="fas fa-trophy"></i> Bonus Challenge</h5>
                        <p>Once you complete the basic functionality, try adding a "Clear Completed" button that removes
                            all finished tasks at once!</p>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-rocket"></i> Understanding the Big Picture</h2>
                    <p>What you're building today is the foundation of how most web applications work:</p>

                    <h3>The Data-UI Connection</h3>
                    <p>Your <code>todos</code> array is your "data" - it represents the current state of your
                        application. Every time you modify this data (add, toggle, delete), you update the UI to match.
                        This pattern is used in professional web development!</p>

                    <h3>Event-Driven Programming</h3>
                    <p>Your app responds to user events (clicks) by calling functions that modify data and update the
                        display. This reactive approach makes your app feel responsive and modern.</p>

                    <h3>Next Steps</h3>
                    <p>In Lesson 10, we'll add data persistence so your todos survive page refreshes, and we'll polish
                        the app with animations and better styling. You're building real developer skills!</p>
                </div>
            </div>
        </div>

        <!-- Right Hands-on Panel -->
        <div class="hands-on-panel">
            <div class="hands-on-header">
                <h2 class="hands-on-title">Advanced Todo App</h2>
                <span class="activity-badge">Activity: Full Functionality</span>
            </div>

            <div class="editor-container">
                <!-- Code Editor -->
                <div class="editor-section">
                    <div class="editor-header">
                        <div class="editor-title">
                            <i class="fas fa-file-code"></i>
                            todo-app.html
                        </div>
                        <button class="run-button" onclick="runCode()">
                            <i class="fas fa-play"></i> Run Code
                        </button>
                    </div>
                    <div id="editor"></div>
                </div>

                <!-- Output -->
                <div class="output-section">
                    <div class="output-header">
                        <div class="d-flex align-items-center" style="gap: 0.5rem;">
                            <i class="fas fa-desktop"></i>
                            <span>Live Preview</span>
                        </div>
                        <button class="expand-btn" id="openPreviewBtn" title="Open in new tab">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path
                                    d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" />
                            </svg>
                        </button>
                    </div>
                    <iframe id="output"></iframe>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
    <script>
        // Define openPreviewInNewTab in global scope so it can be accessed by the button
        let globalEditor;

        function openPreviewInNewTab() {
            if (globalEditor) {
                const code = globalEditor.getValue();
                const blob = new Blob([code], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                window.open(url, '_blank');
            }
        }

        let editor;

        // Initialize Monaco Editor
        require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' } });
        require(['vs/editor/editor.main'], function () {
            editor = monaco.editor.create(document.getElementById('editor'), {
                value: `<!DOCTYPE html>
<html>
<head>
    <title>Advanced Todo App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { 
            padding: 20px; 
            min-height: 100vh;
            background-color: aliceblue;
        }
        .todo-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .todo-item {
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 1rem;
            padding: 1rem;
            border-left: 4px solid #667eea;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }
        .todo-item.completed {
            opacity: 0.7;
            border-left-color: #28a745;
        }
        .todo-item.completed .todo-text {
            text-decoration: line-through;
            color: #6c757d;
        }
        .todo-content {
            display: flex;
            align-items: center;
            flex-grow: 1;
        }
        .todo-checkbox {
            width: 18px;
            height: 18px;
            margin-right: 12px;
        }
        .todo-text {
            font-size: 1.1rem;
        }
        .delete-btn {
            background: none;
            border: none;
            color: #dc3545;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        .delete-btn:hover {
            background: rgba(220, 53, 69, 0.1);
        }
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 1.5rem 0;
            padding: 1rem;
            background-color: aliceblue;
            border-radius: 10px;
        }
        .stat-item {
            text-align: center;
        }
        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
        }
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        .empty-state {
            text-align: center;
            padding: 2rem;
            color: #6c757d;
        }
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>

<div class="todo-container">
    <div class="text-center mb-4">
        <h1><i class="fas fa-tasks"></i> Advanced Todo App</h1>
        <p class="text-muted">Complete tasks, delete them, and track your progress!</p>
    </div>
    
    <form id="todoForm" onsubmit="addTodo(event)">
        <div class="input-group mb-3">
            <input type="text" id="todoInput" class="form-control form-control-lg" 
                   placeholder="What needs to be done?" required>
            <button type="submit" class="btn btn-primary btn-lg">
                <i class="fas fa-plus"></i> Add
            </button>
        </div>
    </form>
    
    <div class="stats">
        <div class="stat-item">
            <div class="stat-number" id="totalTodos">3</div>
            <div class="stat-label">Total</div>
        </div>
        <div class="stat-item">
            <div class="stat-number" id="activeTodos">1</div>
            <div class="stat-label">Active</div>
        </div>
        <div class="stat-item">
            <div class="stat-number" id="completedTodos">2</div>
            <div class="stat-label">Completed</div>
        </div>
    </div>
    
    <div id="todoList"></div>
    
    <div id="emptyState" class="empty-state" style="display: none;">
        <i class="fas fa-clipboard-list"></i>
        <h3>No tasks yet!</h3>
        <p>Add your first task above to get started</p>
    </div>
</div>

<script>
    // Our todo data - each todo has an id, text, and completed status
    let todos = [
        { id: 1, text: 'Learn HTML and CSS', completed: true },
        { id: 2, text: 'Master JavaScript basics', completed: true },
        { id: 3, text: 'Build an awesome todo app', completed: false }
    ];

    // Add a new todo
    function addTodo(event) {
        event.preventDefault();
        const input = document.getElementById('todoInput');
        const text = input.value.trim();
        
        if (text === '') return;
        
        const newTodo = {
            id: Date.now(), // Use timestamp as unique ID
            text: text,
            completed: false
        };
        
        todos.unshift(newTodo); // Add to beginning of array
        input.value = '';
        
        displayTodos();
        updateStats();
    }
    
    // YOUR MISSION: Complete these functions!
    
    // STEP 1: Complete toggleTodo(id)
    function toggleTodo(id) {
        // 1: Your task - Implement the toggle functionality
        // Hint: Use todos.map() to create a new array
        // Hint: For each todo, check if todo.id === id
        // Hint: If it matches, return { ...todo, completed: !todo.completed }
        // Hint: If it doesn't match, return todo unchanged
        // Hint: Replace the todos array with your new mapped array
        
        // 2: After implementing the logic above,
        // Display the todos;
        // Update the stats;
    }
    
    // STEP 2: Complete deleteTodo(id)
    function deleteTodo(id) {
        // 1: Your task - Implement the delete functionality
        // Hint: Use todos.filter() to create a new array
        // Hint: Keep only todos where todo.id !== id (not equal to the id we want to delete)
        // Hint: Replace the todos array with your filtered array
        
        // 2: After implementing the logic above, 
        // Display the todos
        // Update stats
    }
    
    // STEP 3: Complet updateStats()
    function updateStats() {
        // 1: Calculate the statistics
        // Hint: Get the total todos count
        // Hint: todos.length
        // Hint: Filter to get the completed
        // Hint: todos.filter(todo => todo.completed).length
        // Hint: Calculate the active todos,
        // Hint: active = total - completed
        
        // 2: Update the HTML elements
        // Hint: Get the total todos element,
        // Hint: Set textContent = total
        // Hint: Get the active todos element,
        // Hint: Set the textContent = active
        // Hint: Get the completed todos element, 
        // Hint: Set the textContent = completed
    }
    
    // Display all todos in the UI
    function displayTodos() {
        const todoList = document.getElementById('todoList');
        const emptyState = document.getElementById('emptyState');
        
        if (todos.length === 0) {
            todoList.innerHTML = '';
            emptyState.style.display = 'block';
            return;
        }
        
        emptyState.style.display = 'none';
        
        todoList.innerHTML = todos.map(todo => \`
            <div class="todo-item \${todo.completed ? 'completed' : ''}">
                <div class="todo-content">
                    <input type="checkbox" class="todo-checkbox" 
                           \${todo.completed ? 'checked' : ''} 
                           onchange="toggleTodo(\${todo.id})">
                    <span class="todo-text">\${escapeHtml(todo.text)}</span>
                </div>
                <button class="delete-btn" onclick="deleteTodo(\${todo.id})" title="Delete task">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        \`).join('');
    }
    
    // Helper function to prevent HTML injection
    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
    
    // Initialize the app when page loads
    document.addEventListener('DOMContentLoaded', function() {
        displayTodos();
        updateStats();
    });
    
<\/script>

</body>
</html>`,
                language: 'html',
                theme: 'vs',
                fontSize: 14,
                minimap: { enabled: false },
                scrollBeyondLastLine: false,
                automaticLayout: true,
                tabSize: 4,
                insertSpaces: true,
                wordWrap: 'on',
                lineNumbers: 'on',
                folding: true,
                bracketMatching: 'always',
                autoIndent: 'full'
            });

            // Store reference to global scope
            globalEditor = editor;

            // Auto-run code when user stops typing
            let timeout;
            editor.onDidChangeModelContent(() => {
                clearTimeout(timeout);
                timeout = setTimeout(runCode, 500);
            });

            // Initial run
            runCode();

            // Attach event listener to the open preview button
            document.getElementById('openPreviewBtn').addEventListener('click', openPreviewInNewTab);
        });

        function runCode() {
            const code = editor.getValue();
            const output = document.getElementById('output');

            const blob = new Blob([code], { type: 'text/html' });
            const url = URL.createObjectURL(blob);

            output.src = url;

            updateProgress(code);
        }

        function updateProgress(code) {
            const progressFill = document.querySelector('.progress-fill');
            const progressText = document.getElementById('progress-text');
            let progress = 10; // Base progress for having the starter code

            // Check for toggleTodo implementation
            if (code.includes("todos = todos.map(")) progress += 10;
            if (code.includes("todo.id === id")) progress += 10;
            if (code.includes("{ ...todo, completed: !todo.completed }")) progress += 15;
            if (code.includes("displayTodos();") && code.includes("updateStats();") && 
                !code.includes("// displayTodos();") && !code.includes("// updateStats();")) progress += 5;

            // Check for deleteTodo implementation
            if (code.includes("todos = todos.filter(")) progress += 10;
            if (code.includes("todo.id !== id")) progress += 15;

            // Check for updateStats implementation - be more specific
            if (code.includes("const total = todos.length")) progress += 8;
            if (code.includes("const completed = todos.filter(todo => todo.completed).length")) progress += 8;
            if (code.includes("const active = total - completed")) progress += 4;
            if (code.includes("getElementById('totalTodos').textContent = total")) progress += 5;
            if (code.includes("getElementById('activeTodos').textContent = active")) progress += 5;
            if (code.includes("getElementById('completedTodos').textContent = completed")) progress += 5;

            const finalProgress = Math.min(progress, 100);
            progressFill.style.width = finalProgress + '%';
            progressText.textContent = finalProgress + '%';
        }

        login();
    </script>
</body>

</html>